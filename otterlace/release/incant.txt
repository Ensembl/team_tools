That I record the commandline I used in here, suggests we need a
config file for the build.  YAML input to select options?  It would
save re-quoting the environment variables, too.

        (still true, but much improved now)


assume
  PATH=$PATH:$ANACODE_TEAM_TOOLS/otterlace/release/scripts


build to home directory & local Apache,

  mkdir ~/_swac
  ln -snvf /software/anacode/lib ~/_swac/

  otter_nfswub=~/_httpd/OTTER otter_swac=~/_swac build_log=~/_swac/build_log.yaml otter_suffix=arch:distro  otterlace_build ~zmap/BUILD.DEVELOPMENT.{lenny,lucid}


otterlace_dev build
  otterlace_build ~zmap/BUILD.DEVELOPMENT.{lenny,lucid}


building 58.* releases,

  # Build from clean working copy
  cd ~/gitwk-anacode/eo.58
  git branch -v
  git pull

  # tag it
  otterlace_release_tag --minor 58

  # build
  otterlace_build ~zmap/BUILD.DEVELOPMENT.{lenny,lucid}

  # check server status
  diffdevlive /nfs/WWWdev/SANGER_docs/{lib,data,cgi-bin}/otter/58 | ~mca/bin/ansi_bleach | grep -vE '^ *- *X *X *SANGER'

  # Fix symlinks manually, there is only one now.  Using the script
  # would mean having configuration to drive it,
  # (which is now available)
  ssh lenny-dev32
  minor=02
  cd /software/noarch/linux-i386/anacode/otter
  ls -l
  ln -snvf otter_rel58.$minor-lenny otter_test; ln -snvf otter_rel58.$minor-lenny otter_test-lenny; ln -snvf otter_rel58.$minor-lucid otter_test-lucid
  cd /software/noarch/linux-x86_64/anacode/otter
  ls -l
  ln -snvf otter_rel58.$minor-lenny otter_test; ln -snvf otter_rel58.$minor-lenny otter_test-lenny; ln -snvf otter_rel58.$minor-lucid otter_test-lucid

  # wait
  check-software-replication-one-loop


Rebuilding just the server

  (to a disposable non-live copy, using a null zmap build directory)
  This uses the recently deprecated code path.

    mkdir -p /tmp/junk/{srv,cli}
    otter_nfswub=/tmp/junk/srv otter_swac=/tmp/junk/cli build_log=/tmp/junk/build_log.yaml \
      client_build_hosts=' ' /nfs/users/nfs_m/mca/gitwk-anacode/team_tools.stable/otterlace/release/scripts/otterlace_build /tmp/junk/zmapbuild

    diff -ru /tmp/junk/srv/cgi-bin/otter/57 /nfs/WWWdev/SANGER_docs/cgi-bin/otter/57
    diff -ru /tmp/junk/srv/lib/otter/57 /nfs/WWWdev/SANGER_docs/lib/otter/57

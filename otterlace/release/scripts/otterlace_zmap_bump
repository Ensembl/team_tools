#!/bin/sh


#  This updates the zmap version to the current BUILD.DEVELOPMENT.


#  TO DO

#  Check that we are in a ensembl-otter repository.

#  Check that we are not on the development branch.

#  / TO DO


config_set() {
    local key value
    key="$1"
    value="$2"
    sed -i -e "1s|.*|${value}|" "dist/conf/${key}"
}

git_show_maybe() { # pending a $verbose option
    #git show
    true
}

# Could differ from what we're operating upon, but probably doesn't
thisprog="$0 ($( cd $( dirname "$0") && git log -1 --format=%h ))"

zmap_path="$( readlink ~zmap/BUILD.DEVELOPMENT )"

config_set "zmap_path" "$zmap_path" &&
git commit -a -m "$( printf "New ZMap release: %s.\n\nGenerated by %s\n" "$zmap_path" "$thisprog" )" &&
git_show_maybe &&
true

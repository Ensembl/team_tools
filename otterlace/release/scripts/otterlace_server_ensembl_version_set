#!/bin/bash


# This sets the ensembl version used by the Otterlace CGI scripts.


. "$( dirname "$0" )/_otterlace.sh"


# check the usage
server_ensembl_version="$1"
[ -n "$server_ensembl_version" ] || bail "usage: $( basename "$0" ) <server_ensembl_version>"

$dist_scripts/git-is-synced || bail "The repository is not in sync, aborting"

config_set server_ensembl_version "$server_ensembl_version" &&
sed -i \
    -e "/\<SangerPaths\>/s/\<ensembl[[:alnum:]]*\>/ensembl${server_ensembl_version}/" \
    scripts/apache/* &&
git commit -a -m "$( printf "EnsEMBL server version set to %d.\n\nGenerated by %s\n" "$server_ensembl_version" "$thisprog" )" &&
printf "\n\nExpecting you to push now!\n" &&
true
